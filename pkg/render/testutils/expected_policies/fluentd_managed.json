{
  "apiVersion": "projectcalico.org/v3",
  "kind": "NetworkPolicy",
  "metadata": {
    "name": "allow-tigera.allow-fluentd-node",
    "namespace": "tigera-fluentd"
  },
  "spec": {
    "tier": "allow-tigera",
    "order": 1,
    "selector": "k8s-app == \"fluentd-node\"",
    "types": [
      "Ingress",
      "Egress"
    ],
    "ingress": [
      {
        "action": "Allow",
        "protocol": "TCP",
        "source": {
          "selector": "(app == 'prometheus' && prometheus == 'calico-node-prometheus') || (app.kubernetes.io/name == 'prometheus' && prometheus == 'calico-node-prometheus')",
          "namespaceSelector": "projectcalico.org/name == \"tigera-prometheus\""
        },
        "destination": {
          "ports": [
            "9081"
          ]
        }
      }
    ],
    "egress": [
      {
        "action": "Deny",
        "protocol": "TCP",
        "source": {},
        "destination": {
          "selector": "k8s-app == \"tigera-guardian\"",
          "namespaceSelector": "projectcalico.org/name == \"tigera-guardian\"",
          "notPorts": [
            8080
          ]
        }
      },
      {
        "action": "Allow"
      }
    ]
  }
}
